
user nobody;

worker_processes auto;


events {
    worker_connections 1024;
}
http {

    include /etc/nginx/mime.types;
    include /etc/nginx/api_upstream_conf.d/*.conf;
    include /etc/nginx/api_gateway_conf.d/*.conf;
    include /etc/nginx/api_products_conf.d/*.conf;
    include /etc/nginx/api_keys_conf.d/*.conf;

    default_type application/octet-stream;

    sendfile on;
    keepalive_timeout 60;

    lua_ssl_trusted_certificate  /etc/ssl/certs/ca-certificates.crt;
    lua_package_path  "/usr/local/share/lua/5.4/?.lua;;";
    lua_ssl_verify_depth  2;
    resolver  8.8.8.8;
    sendfile  on;
    limit_req  zone=apiwiz  burst=1 nodelay;
    limit_req_zone  $binary_remote_addr zone=apiwiz:10m rate=5r/s;


}
